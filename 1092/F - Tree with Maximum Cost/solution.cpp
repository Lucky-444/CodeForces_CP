#include <bits/stdc++.h>using namespace std;using ll = long long; const int N = 2e5 + 5;vector<int> adj[N];vector<ll> a(N), ans(N), subtreeSum(N);ll totalSum;int n; void dfs1(int node, int parent, int depth){         // add weighted contribution for root (node 1 initially)         ans[1] += 1LL * a[node] * depth;          subtreeSum[node] = a[node];         for (int v : adj[node])         {                  if (v == parent)                           continue;                   dfs1(v, node, depth + 1);                  subtreeSum[node] += subtreeSum[v];         }} void dfs2(int node, int parent){         for (int child : adj[node])         {                  if (child == parent)                           continue;                   ans[child] = ans[node] - subtreeSum[child] + (totalSum - subtreeSum[child]);                  dfs2(child, node);         }} int32_t main(){         ios::sync_with_stdio(false);         cin.tie(nullptr);          cin >> n;         totalSum = 0;          for (int i = 1; i <= n; i++)         {                  cin >> a[i];                  totalSum += a[i];         }          for (int i = 0; i < n - 1; i++)         {                  int u, v;                  cin >> u >> v;                  adj[u].push_back(v);                  adj[v].push_back(u);         }          dfs1(1, -1, 0);         dfs2(1, -1);          ll answer = 0;         for (int i = 1; i <= n; i++)                  answer = max(answer, ans[i]);          cout << answer << "\n";          return 0;}